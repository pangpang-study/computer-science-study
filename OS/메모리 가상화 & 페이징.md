## 메모리 가상화

**메모리 가상화**

- CPU 가상화와 같은 방식으로 실제 프로세스들은 하나의 메모리에서 특정 영역을 차지하고 있는 것이지만 각각 자신의 메모리가 있다고 착각하게 만드는 것.
- 여러 개의 프로세스들이 메모리의 일정 부분을 함께 사용하게 됨.(Memory sharing)

**메모리 가상화의 필요성**

- 초기의 컴퓨터의 메모리 구성: OS와 현재 사용 중인 프로그램. -> 프로세스의 수는 하나로, 프로그램을 동시에 하나만 실행했음.
- 요즘 컴퓨터는 여러 개의 프로그램을 동시에 실행함. -> 메모리 가상화를 하지 않는다면 여러 프로세스들이 한 번에 메모리에 존재할 때 보안상 문제 발생할 수 있음.

**메모리 가상화의 목표**

1. 투명성(Transparency)
  - OS는 실행 중인 프로그램이 메모리가 가상화된다는 사실을 모르게 해야함.
  - 프로그램은 마치 자신에게 하나의 독립적인 실제 메모리가 있는 것처럼 작동해야 함.

2. 효율성(Efficiency)
  - OS는 시간과 공간적 측면에서 효율적으로 가상화를 수행하도록 해야함.
  - 시간 효율을 위해 TLB와 같은 하드웨어 지원을 받아야 함.
  
3. 보안(Protection)
  - OS는 프로세스들로부터 프로세스를 보호하고 OS 자신도 프로세스로부터 보호해야 함.
  - 여러 프로세스들이 각각 자신의 주소 공간에만 접근할 수 있도록 해야함.

## 주소 공간과 주소 변환

**주소 공간(The Address Space)**

- 운영 체제가 프로세스들에게 나눠주기 위해 실제 메모리를 추상화한 메모리.
- 프로세스의 주소 공간에는 해당 프로세스의 코드(text), 전역 변수를 저장하는 공간(Data), 지역 변수를 저장하는 공간(Stack), 동적 할당받은 데이터를 저장하는 공간(Heap)이 있음.
- 프로세스는 자신의 주소 공간에만 접근해야 함. -> OS를 통해 제어해줌.

**주소 변환(Address Translation)**

- 하드웨어의 지원을 받으며 OS가 제어하는 방식으로 구현.
- OS는 프로그램이 자신에게 할당된 메모리에만 접근하도록 제어함.
  -> 다른 프로그램으로부터 프로그램을 보호할 수 있게 됨.
- 주소 변환을 통해 하드웨어는 virtual address(가상 주소)를 physical address(실제 주소)로 변환함.
- 모든 메모리 참조에서 프로그램 메모리 참조를 실제 주소로 변환하기 위해 하드웨어가 주소 변환을 수행함.
